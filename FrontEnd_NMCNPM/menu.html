<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <title>MENU</title>
        <link rel="stylesheet" href="./assets/css/menu.css">
    </head>
    <body>
        <!-- Header -->
        <div class="header">
            <div class="logo"></div>
            <div class="nav">
                <a href="#" id="roleDisplay" style="display: none;">Manager</a>
                <a href="login.html" class="login-btn">Login</a>
                <a href="#" id="search-icon">üîç</a>
                <a href="#" id="menu-icon" onclick="toggleSidebar()">‚ò∞</a>
            </div>
        </div>

        <!-- Menu -->
        <div class="menu">
            <h2>Menu</h2>
            <div class="search-bar">
                <input type="text" placeholder="T√¨m ki·∫øm s·∫£n ph·∫©m..." id="search">
                <button>T√¨m ki·∫øm</button>
            </div>
            <div class="menu-tabs">
                <button class="menu-tab active" data-category="all">T·∫•t c·∫£</button>
                <button class="menu-tab" data-category="COMBO">Combo</button>
                <button class="menu-tab" data-category="FOOD">M√≥n ƒÉn</button>
                <button class="menu-tab" data-category="DRINK">ƒê·ªì u·ªëng</button>
            </div>
            <div class="menu-items">
                <!-- C√°c m√≥n ƒÉn s·∫Ω ƒë∆∞·ª£c th√™m v√†o ƒë√¢y -->
                <div class="menu-item" style="background-image: url();">
                    <p>T√™n m√≥n ƒÉn</p>
                </div>
                <!-- Th√™m c√°c m√≥n ƒÉn t∆∞∆°ng t·ª± v√†o ƒë√¢y -->
            </div>
        </div>
        <script type="text/javascript">
            const menuApi = 'http://localhost:3000/foods';

            function start() {
                getMenu('all', function(filteredItems) {
                    renderMenu(filteredItems);
                    setUpTap();
                });
            }

            start();

            function getMenu(filterCategory,callback) {
                fetch(menuApi)
                    .then(function(response) {
                        return response.json();
                    })
                    .then(menuItems => {
                        const filteredItems = menuItems.filter(menuItem => {
                            filterCategory === 'all' || menuItem.category === filterCategory;
                        });
                        callback(filteredItems);
                    })
                    .catch(error => {
                        console.log('c√≥ l·ªói khi nh·∫≠n gi·ªØ li·ªáu', error);
                    });
            }

            function renderMenu(menuItems) {
                const menuBlock = document.querySelector('.menu-items');

                var htmls = menuItems.map(function(menuItem) {
                    return `<div class="menu-item">
                        <img src="${menuItem.image}" alt="${menuItem.name}">
                        <p>${menuItem.name}</p>
                        <p>Gi√° ti·ªÅn: ${menuItem.price}</p>
                      </div>`
                });
                menuBlock.innerHTML = htmls.join('');
            }

            function setUpTap() {
                const tabs = document.querySelectorAll('.menu-tab');

                tabs.forEach(tab => {
                    tab.addEventListener('click', function () {
                        tabs.forEach(tab => tab.classList.remove('active'));
                        this.classList.add('active');

                        const selectedCategory = this.dataset.category;

                        getMenu(selectedCategory, function(filteredItems) {
                        renderMenu(filteredItems);
                        });
                    });
                });
            }
        </script>
    </body>
</html>